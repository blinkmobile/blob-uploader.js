/*
 * blob-uploader.js: v0.0.1 | https://github.com/blinkmobile/blob-uploader.js#readme
 * (c) 2017 BlinkMobile | Released under the MIT license
 */
!function(e,r){if("function"==typeof define&&define.amd)define(["module"],r);else if("undefined"!=typeof exports)r(module);else{var t={exports:{}};r(t),e.blobUploader=t.exports}}(this,function(e){"use strict";function r(e){if(!e)throw new TypeError("blobUploader expects a api URL during instansiation");t.set(this,{uri:e})}var t=new WeakMap;r.prototype.uploadBlob=function(e){var r=this;if(!e)return Promise.reject(new Error("blob argument not passed in"));if(!t||!t.get(this))return Promise.reject(new Error("blobUploader uri not configured"));var o=t.get(this);if(!o||!o.hasOwnProperty("uri"))return Promise.reject(new Error("blobUploader uri not configured"));var n=new Request(o.uri,{method:"POST",mode:"cors",headers:new Headers({"Content-Type":"text/plain"})});return fetch(n).then(function(e){return e.ok?e.json():Promise.reject(new Error("Error calling blob api service: "+e.status+" "+e.statusText))}).then(function(t){return r._uploadToS3(e,t.putUrl),t.id}).catch(function(e){return Promise.reject(new Error("Error calling blob api service: "+e))})},r.prototype._uploadToS3=function(e,r){var t=new Request(r,{method:"PUT",mode:"cors",body:e,headers:new Headers({"Content-Type":" "})});return fetch(t).then(function(e){if(!e.ok)return Promise.reject(Error("Error uploading to S3: "+e.status+" "+e.statusText))}).catch(function(e){return Promise.reject(new Error("Error uploading to S3: "+e))})},e.exports=r});