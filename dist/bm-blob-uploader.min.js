/*
 * blob-uploader.js: v0.0.1 | https://github.com/blinkmobile/blob-uploader.js#readme
 * (c) 2017 BlinkMobile | Released under the MIT license
 */
!function(e,t){if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var r={exports:{}};t(r.exports),e.blobUploader=r.exports}}(this,function(e){"use strict";function t(e){if(!e)throw new TypeError("blobUploader expects a api URL during instansiation");r.set(this,{uri:e})}Object.defineProperty(e,"__esModule",{value:!0});var r=new WeakMap;t.prototype.uploadBlob=function(e){var t=this;return e?new Promise(function(n,o){var s=new XMLHttpRequest;s.open("POST",r.get(t).uri,!0),s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE){if(200===s.status){var t=JSON.parse(s.responseText);return this._uploadToS3(e,t.putUrl).then(function(){n(t.id)}).catch(o)}return o(new Error("Error calling blob upload service "+s.status+" message: "+s.responseText))}},s.send()}):Promise.reject(new Error("blob argument not passed in"))},t.prototype._uploadToS3=function(e,t){return new Promise(function(r,n){var o=new XMLHttpRequest;o.open("PUT",t,!0),o.onreadystatechange=function(){o.readyState===XMLHttpRequest.DONE&&(200===o.status?r():n(new Error("Error uploading file: "+o.status+" message: "+o.responseText)))},o.setRequestHeader("Content-type"," "),o.send(e)})},e.default=t});