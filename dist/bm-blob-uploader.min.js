/*
 * blob-uploader.js: v0.0.1 | https://github.com/blinkmobile/blob-uploader.js#readme
 * (c) 2017 BlinkMobile | Released under the MIT license
 */
!function(e,t){if("function"==typeof define&&define.amd)define(["module"],t);else if("undefined"!=typeof exports)t(module);else{var n={exports:{}};t(n),e.blobUploader=n.exports}}(this,function(e){"use strict";function t(e){if(!e)throw new TypeError("blobUploader expects a api URL during instansiation");n.set(this,{uri:e})}var n=new WeakMap;t.prototype.uploadBlob=function(e){var t=this;return e?new Promise(function(r,o){var s=t,a=new XMLHttpRequest;a.open("POST",n.get(t).uri,!0),a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE){if(200===a.status){var t=JSON.parse(a.responseText);return s._uploadToS3(e,t.putUrl).then(function(){r(t.id)}).catch(o)}return o(new Error("Error calling blob upload service "+a.status+" message: "+a.responseText))}},a.send()}):Promise.reject(new Error("blob argument not passed in"))},t.prototype._uploadToS3=function(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open("PUT",t,!0),o.onreadystatechange=function(){o.readyState===XMLHttpRequest.DONE&&(200===o.status?n():r(new Error("Error uploading file: "+o.status+" message: "+o.responseText)))},o.setRequestHeader("Content-type"," "),o.send(e)})},e.exports=t});